<div class="app-container">
  <div class="flex-grow-1">
    <nav ngbNav #nav="ngbNav" class="app-navbar navbar navbar-expand-lg position-fixed shadow w-100">
      <div class="container-xxl">
        <button [class.v-hidden]="router.isActive('/', true)" (click)="showSidebar()" class="navbar-toggler"
                style="--bs-navbar-toggler-focus-width: 0; --bs-navbar-toggler-border-color: transparent;font-size: 1.2rem;"
                type="button">

          <ng-icon name="bootstrap-list"></ng-icon>
        </button>
        <a class="navbar-brand sm-center" routerLink="">
          <img src="{{host}}assets/turtle.svg" alt="turtle" width="30" height="24"
               class="d-inline-block align-text-top"/>
          RinNET
        </a>
        <ng-template #userPopContent>
          <div class="user-popover vstack">
            <label class="text-start mx-2 h5">{{authenticationService.currentAccountValue.name}}</label>
            <hr class="my-2 border">
            <a class="link-btn rounded mb-2" [class.active]="isActive('/cards')" routerLink="/cards">{{'App.UserPopup.MyCards' | translate}}</a>
            <a class="link-btn link-btn-danger rounded" (click)="logout()">{{'App.UserPopup.SignOut' | translate}}</a>
          </div>
        </ng-template>

        <div class="hstack gap-1">
          <button *ngIf="account"
                  class="btn btn-icon py-0"
                  style="font-size: 1.2rem;"
                  container="body"
                  placement="bottom-right"
                  [ngbPopover]="userPopContent"
                  type="button">
            <ng-icon name="bootstrap-person"></ng-icon>
          </button>
        </div>
      </div>
    </nav>
    <div class="position-relative">
      <div *ngIf="loading$ | async">
        <div class="progress position-fixed fixed-top" style="margin-top: 3.6rem">
          <div class="progress-bar indeterminate-front" role="progressbar"></div>
        </div>
        <div class="progress position-fixed fixed-top bg-transparent" style="margin-top: 3.6rem">
          <div class="progress-bar indeterminate-back" role="progressbar"></div>
        </div>
      </div>
      <div class="d-lg-grid container-xxl" style="grid-template-areas: 'sidebar main'; grid-template-columns: auto 1fr">
        <aside #sidebar class="sidebar d-block overflow-y-auto position-sticky"
               [class.d-none]="router.isActive('/', true)">
          <div id="sidebar" class="offcanvas-lg offcanvas-start" tabindex="-1">
            <div class="offcanvas-header" style="height: 3.6rem">
              <h5 class="offcanvas-title" id="offcanvasExampleLabel">Navigation</h5>
              <button type="button" class="btn-close" aria-label="Close"
                      (click)="hideSidebar()"></button>
            </div>
            <div class="offcanvas-body user-select-none">
              <nav>
                <ul class="list-unstyled mt-2">
                  <li>
                    <ul class="list-unstyled pb-2 ps-3 small">
                      <li class="pb-2">
                        <a class="link-btn rounded" [class.active]="isActive('/dashboard')" (click)="navigateTo('/dashboard')">{{'App.Sidebar.Dashboard' | translate}}</a>
                      </li>
                      <li class="pb-2">
                        <a class="link-btn rounded" [class.active]="isActive('/import')" (click)="navigateTo('/import')">{{'App.Sidebar.Import' | translate}}</a>
                      </li>
  <!--                    <li class="pb-2">-->
  <!--                      <a class="link-btn rounded" target="_blank"-->
  <!--                         href="https://status.naominet.live/status/aquaserver">{{'App.Sidebar.Status' | translate}}</a>-->
  <!--                    </li>-->
                    </ul>
                  </li>
                  <li *ngIf="filterItems(ongekiMenu).length != 0">
                    <div class="d-flex mb-2 ps-1 gap-2">
                      <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 1024 1024">
                          <path d="M985.2,512.9c14.1-27,12.5-54.7-19-54.7c-4.7,0-12.6,0-23.7,0c12.6-28.7,32.9-72.2,38.7-105.1
      c16.3-93.3-31.9-165.6-124.6-186.1c-44-9.7-88.7-10-132.4-2.4C555.8,194,427.6,284.8,333,425c-6.1,9.1-11.6,18.6-17.5,28.2
      c-5.6,0.6-10.8,1.7-15.5,1.9c-33,1-57.5,12.3-75,43.7c-52.6,94.5-107.9,187.5-162.2,281.1c-5.5,9.6-11.9,18.9-16.1,29
      c-12,29.2,1.3,54,32.4,55.3c47.8,2,95.8,0.5,141.2,0.5C261,801,430,496,452.8,453.6c-24.6,0-48.5,0-75.2,0
      c7.7-19.1,17.7-31.4,27.6-43.7c60.7-75.4,136.7-130.3,225.6-168.4c62.7-26.9,128.1-35,195.4-29c79,7,121.3,64.8,103.8,141.6
      c-8,35-22.4,74.1-44.3,102.5c-25.3,0-47.4,0-77.5,1.1c-76.7,132.5-153.5,265.3-234.5,405.3c60.3,0,114.3,1.9,166,0.5
      c31-0.9,49.4-11.1,65.1-37.4C868,720,889,682,939.5,592.9C954.6,566.2,970.9,540.1,985.2,512.9z"/>
                          <path d="M129.5,531.5C89.3,601.8,48,671.4,8.1,741.8C-7.6,769.7,0,789,32.3,800.5c55.7-96,111.4-192.1,169.2-291.9
      C170,509,145.1,504.2,129.5,531.5z"/>
                          <path d="M991.9,531c-55.7,96-111.4,192.1-169.2,291.9c31.6-0.4,56.5,4.4,72.1-23c40.2-70.3,81.5-139.9,121.3-210.3
      C1031.8,561.8,1024.2,542.5,991.9,531z"/>
                        </svg>
                      </div>
                      <strong class="w-100 fw-semibold">{{'Common.Ongeki' | translate}}</strong>
                    </div>
                    <ul class="list-unstyled pb-2 ps-3 small">
                      <li *ngFor="let item of filterItems(ongekiMenu)" class="pb-2">
                        <a class="link-btn rounded" [class.active]="isActive(item.url)" (click)="navigateTo(item.url)">{{('App.Sidebar.' + item.name) | translate}}</a>
                      </li>
                    </ul>
                  </li>
                  <li *ngIf="filterItems(v2Menus).length != 0">
                    <div class="d-flex mb-2 ps-1 gap-2">
                      <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 1024 1024">
                          <circle class="cls-1" cx="551.62" cy="512.5" r="121.52"/>
                          <path class="cls-1" d="M870.86,780.19c60.77-72.4,97.4-165.76,97.4-267.69,0-115.12-46.69-219.33-122.16-294.74l67.39-67.39C820.96,58.07,693.26,1,552.24,1,269.75,1,40.74,230.01,40.74,512.5s229.01,511.5,511.5,511.5c157.21,0,297.84-70.92,391.67-182.52l-73.05-61.29ZM551.62,781.58c-148.61,0-269.08-120.47-269.08-269.08s120.47-269.08,269.08-269.08,269.08,120.47,269.08,269.08-120.47,269.08-269.08,269.08Z"/>
                        </svg>
                      </div>
                      <strong class="w-100 fw-semibold">{{'Common.ChuniV2' | translate}}</strong>
                    </div>
                    <ul class="list-unstyled pb-2 ps-3 small">
                      <li *ngFor="let item of filterItems(v2Menus)" class="pb-2">
                        <a class="link-btn rounded" [class.active]="isActive(item.url)" (click)="navigateTo(item.url)">{{('App.Sidebar.' + item.name) | translate}}</a>
                      </li>
                    </ul>
                  </li>
                  <li *ngIf="filterItems(mai2Menus).length != 0">
                    <div class="d-flex mb-2 ps-1 gap-2">
                      <div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 1024 1024">
                          <g>
                            <path d="M 1024,512 A 512,512 0 0 1 0,512 A 512,512 0 0 1 1024,512 M 850,512 A 338,338 0 0 0 174,512 A 338,338 0 0 0 850,512 Z"/>
                          </g>
                          <g>
                            <circle cx="775" cy="827" r="7"/>
                            <circle cx="827" cy="775" r="7"/>
                            <circle cx="346.5" cy="617" r="40"/>
                            <circle cx="677.5" cy="617" r="40"/>
                            <path d="M523.4,676.7c-1-9.1-0.8-18.2,0.1-27.6c9.7-6.3,17.9-13.6,19.2-26c-3.1-7.5-9.5-9.9-16.3-10.1c-4.5-0.2-9.6-0.2-14.4-0.1
      c-4.8,0-9.8-0.1-14.4,0.1c-6.8,0.3-13.2,2.6-16.3,10.1c1.3,12.4,9.5,19.7,19.2,26c0.9,9.4,1,18.4,0.1,27.6
      c-9.7,12.8-23.4,21.2-33.5,32.5c-2.5,7.6-0.6,12.8,5.9,16.1c6.7,1.6,11.2-2,15.6-6.1c7.5-7.1,15.1-14.2,23.5-22.1
      c8.4,7.9,15.9,15,23.5,22.1c4.3,4.1,8.9,7.7,15.6,6.1c6.5-3.3,8.4-8.6,5.9-16.1C546.8,697.9,533.1,689.4,523.4,676.7z"/>
                          </g>
                        </svg>
                      </div>
                      <strong class="w-100 fw-semibold">{{'Common.Mai2' | translate}}</strong>
                    </div>
                    <ul class="list-unstyled pb-2 ps-3 small">
                      <li *ngFor="let item of filterItems(mai2Menus)" class="pb-2">
                        <a class="link-btn rounded " [class.active]="isActive(item.url)" (click)="navigateTo(item.url)">{{('App.Sidebar.' + item.name) | translate}}</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </aside>
        <main class="order-1 ms-0 ms-lg-3 me-lg-2" style="grid-area: main;margin-top: 4.6rem">
          <div>
            <router-outlet></router-outlet>
          </div>
        </main>
      </div>
      <app-toasts aria-live="polite" aria-atomic="true" style="margin-top: 3.6rem"></app-toasts>
    </div>
  </div>

  <footer class="footer container-xxl mb-2">
    <hr class="m-0 pt-2">
    <div class="d-flex justify-content-between flex-wrap px-2 px-lg-3 py-3 column-gap-3">
      <div class="row fw-bold my-2">
        <div class="col-auto" ngbDropdown>
          <a ngbDropdownToggle>
            <ng-icon name="bootstrap-translate"></ng-icon>
            <span class="ms-1">{{languageService.languages.get(languageService.getCurrentLang())}}</span>
          </a>
          <div class="dropdown-menu" ngbDropdownMenu>
            <ng-container *ngFor="let key of languageService.languageKeys">
              <button ngbDropdownItem class="small my-1"
              [class.active]="languageService.getCurrentLang() == key"
              (click)="languageService.setCurrentLang(key)">{{languageService.languages.get(key)}}</button>
            </ng-container>
          </div>
        </div>

        <div class="col-auto" ngbDropdown >
          <a ngbDropdownToggle>
            <ng-container [ngSwitch]="themeService.getTheme()">
              <ng-icon *ngSwitchCase="'auto'" name="bootstrap-circle-half"></ng-icon>
              <ng-icon *ngSwitchCase="'light'" name="bootstrap-sun"></ng-icon>
              <ng-icon *ngSwitchCase="'dark'" name="bootstrap-stars"></ng-icon>
            </ng-container>
            <span class="ms-1">{{("App.Footer." + (themeService.getTheme() | titlecase)) | translate}}</span>
          </a>
          <div class="dropdown-menu" ngbDropdownMenu>
            <ng-container *ngFor="let item of themes">
              <button ngbDropdownItem class="small my-1"
              [class.active]="themeService.getTheme() == item.toLowerCase()"
              (click)="themeService.setTheme(item.toLowerCase())">{{('App.Footer.' + item) | translate}}</button>
            </ng-container>
          </div>
        </div>
      </div>
      <div class="row my-2">
        <div class="col-auto">
          <a target="_blank" href="https://status.naominet.live/status/aquaserver">{{"App.Footer.Status" | translate}}</a>
          <a class="ms-4" target="_blank" href="https://github.com/mxihan/aqua_viewer">Github</a>
        </div>
        <div class="col-auto" [innerHTML]="'App.Footer.Licence' | translate"></div>
        <div class="col-auto">
          <a routerLink="contributors">{{"App.Footer.Contributors" | translate}}</a>
        </div>
        <div class="col-auto">{{"App.Footer.Copyright" | translate}}</div>
      </div>
    </div>
  </footer>
</div>
